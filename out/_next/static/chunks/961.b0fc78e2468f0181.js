"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{10961:function(e,r,t){t.r(r),t.d(r,{EthereumPrivateKeyProvider:function(){return ue},TransactionFormatter:function(){return se},WalletConnectProvider:function(){return C},getProviderHandlers:function(){return $}});var n=t(4942),i=t(22782),a=t(95844),o=t(16843),s=t(68531),c=t(79826),f=t(66052),u=t(51091),d=t(53934),p=t(20917),h=t(69282),l=t.n(h),g=t(40660),y=t(70794),m=t(2832),v=t.n(m),w=t(48764).Buffer;function P(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?P(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function x(e){return 42===e.length}function E(e){let{getAccounts:r,getPrivateKey:t,processDecryptMessage:n,processEncryptionPublicKey:i,processEthSignMessage:o,processPersonalMessage:s,processTransaction:f,processSignTransaction:u,processTypedMessage:d,processTypedMessageV3:p,processTypedMessageV4:h}=e;if(!r)throw new Error("opts.getAccounts is required");async function l(e,t){if("string"===typeof e&&e.length>0){const n=(await r(t)).map((e=>e.toLowerCase())),i=e.toLowerCase();if(n.includes(i))return i}throw c.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}return(0,a.v0)({eth_accounts:(0,a.Pk)((async function(e,t){t.result=await r(e)})),eth_private_key:(0,a.Pk)((async function(e,r){if(!t)throw c.ethErrors.rpc.methodNotSupported();r.result=t(e)})),eth_coinbase:(0,a.Pk)((async function(e,t){const n=await r(e);t.result=n[0]||null})),eth_sendTransaction:(0,a.Pk)((async function(e,r){if(!f)throw c.ethErrors.rpc.methodNotSupported();const t=e.params[0]||{from:""};t.from=await l(t.from,e),r.result=await f(t,e)})),eth_signTransaction:(0,a.Pk)((async function(e,r){if(!u)throw c.ethErrors.rpc.methodNotSupported();const t=e.params[0]||{from:""};t.from=await l(t.from,e),r.result=await u(t,e)})),eth_sign:(0,a.Pk)((async function(e,r){if(!o)throw c.ethErrors.rpc.methodNotSupported();const t=await l(e.params[0],e),n=e.params[1],i=b(b({},e.params[2]||{}),{},{from:t,data:n});r.result=await o(i,e)})),eth_signTypedData:(0,a.Pk)((async function(e,r){if(!d)throw c.ethErrors.rpc.methodNotSupported();const t=e.params[0],n=await l(e.params[1],e),i=b(b({},e.params[2]||{}),{},{from:n,data:t});r.result=await d(i,e,"V1")})),eth_signTypedData_v3:(0,a.Pk)((async function(e,r){if(!p)throw c.ethErrors.rpc.methodNotSupported();const t=await l(e.params[0],e),n={data:e.params[1],from:t,version:"V3"};r.result=await p(n,e,"V3")})),eth_signTypedData_v4:(0,a.Pk)((async function(e,r){if(!h)throw c.ethErrors.rpc.methodNotSupported();const t=await l(e.params[0],e),n={data:e.params[1],from:t,version:"V4"};r.result=await h(n,e,"V4")})),personal_sign:(0,a.Pk)((async function(e,r){if(!s)throw c.ethErrors.rpc.methodNotSupported();const t=e.params[0],n=e.params[1],i=e.params[2]||{};let a,o;if(x(t)&&!x(n)){let e="The eth_personalSign method requires params ordered ";e+="[message, address]. This was previously handled incorrectly, ",e+="and has been corrected automatically. ",e+="Please switch this param order for smooth behavior in the future.",r.warning=e,a=t,o=n}else o=t,a=n;a=await l(a,e);const f=b(b({},i),{},{from:a,data:o});r.result=await s(f,e)})),eth_getEncryptionPublicKey:(0,a.Pk)((async function(e,r){if(!i)throw c.ethErrors.rpc.methodNotSupported();const t=await l(e.params[0],e);r.result=await i(t,e)})),eth_decrypt:(0,a.Pk)((async function(e,r){if(!n)throw c.ethErrors.rpc.methodNotSupported();const t=e.params[0],i=await l(e.params[1],e),a=b(b({},e.params[2]||{}),{},{from:i,data:t});r.result=n(a,e)}))})}function _(e){const{getAccounts:r,getPrivateKey:t,processTransaction:n,processSignTransaction:i,processEthSignMessage:o,processTypedMessage:s,processTypedMessageV3:c,processTypedMessageV4:f,processPersonalMessage:u,processEncryptionPublicKey:d,processDecryptMessage:p}=e;return(0,a.UZ)([(0,a.v0)({eth_syncing:!1}),E({getAccounts:r,getPrivateKey:t,processTransaction:n,processEthSignMessage:o,processSignTransaction:i,processTypedMessage:s,processTypedMessageV3:c,processTypedMessageV4:f,processPersonalMessage:u,processEncryptionPublicKey:d,processDecryptMessage:p})])}function O(e){return(r,t,n,i)=>"eth_chainId"===r.method?(t.result=e,i()):n()}function S(e){return(r,t,n,i)=>"eth_provider_config"===r.method?(t.result=e,i()):n()}function T(e){const{chainId:r,rpcTarget:t}=e,n=(0,i.v$)({rpcTarget:t});return{networkMiddleware:(0,a.UZ)([O(r),S(e),n]),fetchMiddleware:n}}function A(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function N(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?A(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}class C extends s.Zk{constructor(e){let{config:r,state:t,connector:i}=e;super({config:{chainConfig:N(N({},r.chainConfig),{},{chainNamespace:o.EN.EIP155}),skipLookupNetwork:!!r.skipLookupNetwork},state:N(N({},t||{}),{},{chainId:"loading",accounts:[]})}),(0,n.Z)(this,"connector",null),this.connector=i||null}async enable(){if(!this.connector)throw c.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});return await this.setupProvider(this.connector),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(e){this.onConnectorStateUpdate(e),await this.setupEngine(e)}async switchChain(e){let{chainId:r,addChain:t=!0,lookup:n=!0}=e;if(!this.connector)throw c.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});const i=this.getChainConfig(r);this.update({chainId:"loading"});const{rpcTarget:a,displayName:s}=i;if(t)try{await this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:s,rpcUrls:[a]}]})}catch(f){o.cM.error(f)}try{await this.connector.sendCustomRequest({method:"wallet_switchEthereumChain",params:[{chainId:r}]})}catch(f){if(o.cM.error(f),"JSON RPC response format is invalid"!==f.message)throw f}this.configure({chainConfig:i}),n&&await this.lookupNetwork(this.connector)}async addChain(e){if(!this.connector)throw o.Ty.notReady("Wallet adapter is not ready yet");const{rpcTarget:r,displayName:t}=e;try{await this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:e.chainId,chainName:t,rpcUrls:[r]}]}),super.addChain(e)}catch(n){throw o.cM.error(n),n}}async lookupNetwork(e){if(!e.connected)throw o.RM.notConnectedError("Wallet connect connector is not connected");if(!this.provider)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const{chainId:r}=this.config.chainConfig,t=(0,o.H2)(e.chainId.toString())?e.chainId:`0x${e.chainId.toString(16)}`;if(r!==t)throw o.Ty.rpcConnectionError(`Invalid network, net_version is: ${t}, expected: ${r}`);return this.provider.emit("connect",{chainId:r}),this.provider.emit("chainChanged",this.state.chainId),t}async setupEngine(e){const r=function(e){let{connector:r}=e;return{getPrivateKey:async()=>{throw c.ethErrors.rpc.methodNotSupported()},getAccounts:async e=>{const{accounts:t}=r;if(t&&t.length)return t;throw new Error("Failed to get accounts")},processTransaction:async(e,t)=>await r.sendTransaction(e),processSignTransaction:async(e,t)=>await r.signTransaction(e),processEthSignMessage:async(e,t)=>await r.signMessage([e.from,e.data]),processPersonalMessage:async(e,t)=>await r.signPersonalMessage([e.data,e.from]),processTypedMessage:async(e,t)=>await r.signTypedData([e.from,e.data]),processTypedMessageV3:async e=>await r.signTypedData([e.from,e.data]),processTypedMessageV4:async e=>await r.signTypedData([e.from,e.data]),processEncryptionPublicKey:async e=>{throw c.ethErrors.rpc.methodNotSupported()},processDecryptMessage:e=>{throw c.ethErrors.rpc.methodNotSupported()}}}({connector:e});this.update({accounts:e.accounts||[]});const t=_(r),n=new a.eI,{networkMiddleware:o}=T(this.config.chainConfig);n.push(t),n.push(o);const s=(0,i.Xj)(n);this.updateProviderEngineProxy(s),this.config.skipLookupNetwork||await this.lookupNetwork(e)}async onConnectorStateUpdate(e){e.on("session_update",(async(r,t)=>{if(!this.provider)throw o.RM.notConnectedError("Wallet connect connector is not connected");if(r)return void this.provider.emit("error",r);const{accounts:n,chainId:i,rpcUrl:a}=t.params[0];null!==n&&void 0!==n&&n.length&&this.state.accounts[0]!==n[0]&&(this.update({accounts:n}),this.provider.emit("accountsChanged",n));const s=`0x${i.toString(16)}`;if(i&&this.state.chainId!==s){const r=(0,o.h2)(o.EN.EIP155,i)||{};this.configure({chainConfig:N(N({},r),{},{chainId:s,rpcTarget:a,chainNamespace:o.EN.EIP155})}),await this.setupEngine(e)}}))}}(0,n.Z)(C,"getProviderInstance",(async e=>{const r=new C({config:{chainConfig:e.chainConfig,skipLookupNetwork:e.skipLookupNetwork}});return await r.setupProvider(e.connector),r}));const k=new y.Z("1e18"),B=new y.Z("1e9"),I=new y.Z("1"),M={hex:e=>"string"===typeof e?new y.Z((0,d.stripHexPrefix)(e),16):new y.Z(e,16),dec:e=>new y.Z(e,10)},j={WEI:e=>e.div(k),GWEI:e=>e.div(B),ETH:e=>e.div(I)},H={WEI:e=>e.times(k).dp(0,y.Z.ROUND_HALF_UP),GWEI:e=>e.times(B).dp(9,y.Z.ROUND_HALF_UP),ETH:e=>e.times(I).dp(9,y.Z.ROUND_HALF_UP)},F={hex:e=>e.toString(16),dec:e=>new y.Z(e).toString(10)},G=(e,r)=>{let{fromNumericBase:t="hex",toNumericBase:n,fromDenomination:i,toDenomination:a,numberOfDecimals:o}=r;return(e=>{const{value:r,fromNumericBase:t,fromDenomination:n,toNumericBase:i,toDenomination:a,numberOfDecimals:o}=e;let s=M[t](r);return n&&(s=j[n](s)),a&&(s=H[a](s)),o&&(s=s.dp(o,y.Z.ROUND_HALF_DOWN)),i&&(s=F[i](s)),s})({fromNumericBase:t,toNumericBase:n,fromDenomination:i,toDenomination:a,numberOfDecimals:o,value:e||"0"})};function D(e){return G(e,{fromNumericBase:"dec",toNumericBase:"hex",fromDenomination:"GWEI",toDenomination:"WEI"})}function K(e){return G(e,{fromNumericBase:"hex",toNumericBase:"dec",fromDenomination:"WEI",toDenomination:"GWEI"})}function L(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function U(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?L(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function R(e){return K(D(e))}const V=(e,r)=>{var t;try{l().ok(e&&"object"===typeof e,"Params must be an object."),l().ok("data"in e,'Params must include a "data" field.'),l().ok("from"in e,'Params must include a "from" field.'),l().ok("string"===typeof e.from&&(0,d.isValidAddress)(e.from),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.');let n=null,i=null;switch(e.version){case u.SignTypedDataVersion.V1:"string"===typeof e.data?l().doesNotThrow((()=>{n=JSON.parse(e.data)}),'"data" must be a valid JSON string.'):n=e.data,l().ok(Array.isArray(n),"params.data must be an array."),l().doesNotThrow((()=>{(0,u.typedSignatureHash)(n)}),"Signing data must be valid EIP-712 typed data.");break;case u.SignTypedDataVersion.V3:case u.SignTypedDataVersion.V4:"string"===typeof e.data?l().doesNotThrow((()=>{n=JSON.parse(e.data)}),'"data" must be a valid JSON string.'):n=e.data,l().ok(n.primaryType in n.types,`Primary type of "${n.primaryType}" has no type definition.`);const a=g.validate(n,u.TYPED_MESSAGE_SCHEMA.properties);l().strictEqual(a.errors.length,0,"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx."),i=null===(t=n.domain)||void 0===t?void 0:t.chainId,i&&(l().ok(!Number.isNaN(r),`Cannot sign messages for chainId "${i}", because Web3Auth is switching networks.`),"string"===typeof i&&(i=Number.parseInt(i,(0,o.H2)(i)?16:10)),l().strictEqual(i,r,`Provided chainId "${i}" must match the active chainId "${r}"`));break;default:l().fail(`Unknown typed data version "${e.version}"`)}}catch(n){throw c.ethErrors.rpc.invalidInput({message:null===n||void 0===n?void 0:n.message})}};function z(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?z(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}async function q(e,r,t){const n=await t.formatTransaction(e),i=await t.getCommonConfiguration();return f.TransactionFactory.fromTxData(n,{common:i}).sign(w.from(r,"hex")).serialize()}function $(e){let{txFormatter:r,privKey:t,getProviderEngineProxy:n}=e;return{getAccounts:async e=>[`0x${(0,d.privateToAddress)(w.from(t,"hex")).toString("hex")}`],getPrivateKey:async e=>t,processTransaction:async(e,i)=>{const a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const o=await q(e,t,r);return await a.request({method:"eth_sendRawTransaction",params:["0x".concat(o.toString("hex"))]})},processSignTransaction:async(e,i)=>{if(!n())throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});return`0x${(await q(e,t,r)).toString("hex")}`},processEthSignMessage:async(e,r)=>(0,i.l)(t,e.data),processPersonalMessage:async(e,r)=>{const n=w.from(t,"hex");return(0,u.personalSign)({privateKey:n,data:e.data})},processTypedMessage:async(e,r)=>{o.cM.debug("processTypedMessage",e);const i=w.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10),d=Z(Z({},e),{},{version:u.SignTypedDataVersion.V1});V(d,f);const p="string"===typeof d.data?JSON.parse(d.data):d.data;return(0,u.signTypedData)({privateKey:i,data:p,version:u.SignTypedDataVersion.V1})},processTypedMessageV3:async(e,r)=>{o.cM.debug("processTypedMessageV3",e);const i=w.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10);V(e,f);const d="string"===typeof e.data?JSON.parse(e.data):e.data;return(0,u.signTypedData)({privateKey:i,data:d,version:u.SignTypedDataVersion.V3})},processTypedMessageV4:async(e,r)=>{o.cM.debug("processTypedMessageV4",e);const i=w.from(t,"hex"),a=n();if(!a)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const s=await a.request({method:"eth_chainId"}),f=Number.parseInt(s,(0,o.H2)(s)?16:10);V(e,f);const d="string"===typeof e.data?JSON.parse(e.data):e.data;return(0,u.signTypedData)({privateKey:i,data:d,version:u.SignTypedDataVersion.V4})},processEncryptionPublicKey:async(e,r)=>(o.cM.info("processEncryptionPublicKey",e),(0,u.getEncryptionPublicKey)(t)),processDecryptMessage:(e,r)=>{o.cM.info("processDecryptMessage",e);const n=(0,d.stripHexPrefix)(e.data),i=w.from(n,"hex");return(0,u.decrypt)({encryptedData:JSON.parse(i.toString("utf8")),privateKey:t})}}}function W(e){return(0,d.addHexPrefix)(e.toString(16))}function J(e){return d.BN.isBN(e)?e:new d.BN((0,d.stripHexPrefix)(e),16)}const X="0x0",Y="0x2",Q="sentEther",ee="contractInteraction",re="contractDeployment",te="fee-market",ne="legacy",ie="eth_gasPrice";function ae(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ae(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ae(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}class se{constructor(e){let{getProviderEngineProxy:r}=e;(0,n.Z)(this,"chainConfig",null),(0,n.Z)(this,"getProviderEngineProxy",void 0),(0,n.Z)(this,"isEIP1559Compatible",!1),this.getProviderEngineProxy=r}get providerProxy(){return this.getProviderEngineProxy()}async init(){this.chainConfig=await this.providerProxy.request({method:"eth_provider_config",params:[]}),this.isEIP1559Compatible=await this.getEIP1559Compatibility()}async getCommonConfiguration(){if(!this.chainConfig)throw new Error("Chain config not initialized");const{displayName:e,chainId:r}=this.chainConfig,t=this.isEIP1559Compatible?m.Hardfork.London:m.Hardfork.Berlin,n={name:e,chainId:"loading"===r?0:Number.parseInt(r,16),networkId:"loading"===r?0:Number.parseInt(r,16),defaultHardfork:t};return v().custom(n)}async formatTransaction(e){if(!this.chainConfig)throw new Error("Chain config not initialized");const r=oe({},e);if(void 0===r.nonce&&(r.nonce=await this.providerProxy.request({method:"eth_getTransactionCount",params:[e.from,"latest"]})),!this.isEIP1559Compatible&&r.gasPrice){if(r.maxFeePerGas&&delete r.maxFeePerGas,r.maxPriorityFeePerGas&&delete r.maxPriorityFeePerGas,r.gas)r.gasLimit=r.gas;else{const e=await this.getDefaultGasLimit(r);e&&(r.gasLimit=e)}return r}if(r.gas)r.gasLimit=r.gas;else{const e=await this.getDefaultGasLimit(r);e&&(r.gasLimit=e)}const{gasPrice:t,maxFeePerGas:n,maxPriorityFeePerGas:i}=await this.getDefaultGasFees(r);var a,o;return this.isEIP1559Compatible?(!r.gasPrice||r.maxFeePerGas||r.maxPriorityFeePerGas?(n&&!r.maxFeePerGas&&(r.maxFeePerGas=n),i&&!r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=i),t&&!r.maxFeePerGas&&(r.maxFeePerGas=t),r.maxFeePerGas&&!r.maxPriorityFeePerGas&&(r.maxPriorityFeePerGas=r.maxFeePerGas)):(r.maxFeePerGas=r.gasPrice,r.maxPriorityFeePerGas=(a="string"===typeof i?(0,d.stripHexPrefix)(i):i,o="string"===typeof r.gasPrice?(0,d.stripHexPrefix)(r.gasPrice):r.gasPrice,null!==a&&void 0!==a&&null!==o&&void 0!==o&&new y.O(a,10).lt(o,10)?i:r.gasPrice)),delete r.gasPrice):(delete r.maxPriorityFeePerGas,delete r.maxFeePerGas),!t||r.gasPrice||r.maxPriorityFeePerGas||r.maxFeePerGas||(r.gasPrice=t),r.type=this.isEIP1559Compatible?Y:X,r.chainId=this.chainConfig.chainId,r}async fetchEthGasPriceEstimate(){return{gasPrice:K(await this.providerProxy.request({method:"eth_gasPrice",params:[]})).toString()}}async getEIP1559Compatibility(){const e=await this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]});return!!(e&&void 0!==e.baseFeePerGas)}async fetchGasFeeEstimateData(){if(!this.chainConfig)throw new Error("Chain config not initialized");const e="0x1"===this.chainConfig.chainId,r=Number.parseInt(this.chainConfig.chainId,16);let t;try{if(this.isEIP1559Compatible){t={gasFeeEstimates:await async function(e){const r=await(0,p.U2)(e);return U(U({},r),{},{estimatedBaseFee:R(r.estimatedBaseFee),low:U(U({},r.low),{},{suggestedMaxPriorityFeePerGas:R(r.low.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:R(r.low.suggestedMaxFeePerGas)}),medium:U(U({},r.medium),{},{suggestedMaxPriorityFeePerGas:R(r.medium.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:R(r.medium.suggestedMaxFeePerGas)}),high:U(U({},r.high),{},{suggestedMaxPriorityFeePerGas:R(r.high.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:R(r.high.suggestedMaxFeePerGas)})})}("https://gas-api.metaswap.codefi.network/networks/<chain_id>/suggestedGasFees".replace("<chain_id>",`${r}`)),gasEstimateType:te}}else{if(!e)throw new Error("Main gas fee/price estimation failed. Use fallback");t={gasFeeEstimates:await async function(e){const r=await(0,p.U2)(e,{referrer:e,referrerPolicy:"no-referrer-when-downgrade",method:"GET",mode:"cors"});return{low:r.SafeGasPrice,medium:r.ProposeGasPrice,high:r.FastGasPrice}}("https://gas-api.metaswap.codefi.network/networks/<chain_id>/gasPrices".replace("<chain_id>",`${r}`)),gasEstimateType:ne}}}catch(n){try{t={gasFeeEstimates:await this.fetchEthGasPriceEstimate(),gasEstimateType:ie}}catch(i){throw new Error(`Gas fee/price estimation failed. Message: ${i.message}`)}}return t}async getDefaultGasFees(e){if(!this.isEIP1559Compatible&&e.gasPrice||this.isEIP1559Compatible&&e.maxFeePerGas&&e.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:e,gasEstimateType:r}=await this.fetchGasFeeEstimateData();if(this.isEIP1559Compatible&&r===te){const{medium:{suggestedMaxPriorityFeePerGas:r,suggestedMaxFeePerGas:t}={}}=e;if(r&&t)return{maxFeePerGas:(0,d.addHexPrefix)(D(t)),maxPriorityFeePerGas:(0,d.addHexPrefix)(D(r))}}else{if(r===ne)return{gasPrice:(0,d.addHexPrefix)(D(e.medium))};if(r===ie)return{gasPrice:(0,d.addHexPrefix)(D(e.gasPrice))}}}catch(t){o.cM.error(t)}const{gasPrice:r}=await this.fetchEthGasPriceEstimate();return{gasPrice:(0,d.addHexPrefix)(D(r))}}async estimateTxGas(e){const r=oe({},e);delete r.gasPrice,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas;return await this.providerProxy.request({method:"eth_estimateGas",params:[r]})}async analyzeGasUsage(e){const r=await this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]});let t=W(function(e,r,t){const n=new d.BN(r),i=new d.BN(t);return e.mul(n).div(i)}(J(r.gasLimit),19,20));try{t=await this.estimateTxGas(e)}catch(n){o.cM.warn(n)}return{blockGasLimit:r.gasLimit,estimatedGasHex:t}}addGasBuffer(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5;const n=J(e),i=J(r).muln(.9),a=n.muln(t);return n.gt(i)?W(n):a.lt(i)?W(a):W(i)}async determineTransactionCategory(e){const{data:r,to:t}=e;let n,i="";if(r&&!t)n=re;else{try{i=await this.providerProxy.request({method:"eth_getCode",params:[t,"latest"]})}catch(a){o.cM.warn(a)}n=!i||"0x"===i||"0x0"===i?Q:ee}return{transactionCategory:n,code:i}}async getDefaultGasLimit(e){const{transactionCategory:r}=await this.determineTransactionCategory(oe({},e));if(e.gas)return e.gas;if(e.to&&r===Q){if(e.data)throw Error("TxGasUtil - Trying to call a function on a non-contract address");const r=21e3;return(0,d.addHexPrefix)(r.toString(16))}const{blockGasLimit:t,estimatedGasHex:n}=await this.analyzeGasUsage(e);return this.addGasBuffer((0,d.addHexPrefix)(n),t)}}function ce(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function fe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ce(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ce(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}class ue extends s.Zk{constructor(e){let{config:r,state:t}=e;super({config:{chainConfig:fe(fe({},r.chainConfig),{},{chainNamespace:o.EN.EIP155})},state:t})}async enable(){if(!this.state.privateKey)throw c.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});return await this.setupProvider(this.state.privateKey),this._providerEngineProxy.request({method:"eth_accounts"})}async setupProvider(e){const r=new se({getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),t=_($({txFormatter:r,privKey:e,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)})),n=this.getChainSwitchMiddleware(),o=new a.eI,{networkMiddleware:s}=T(this.config.chainConfig);o.push(t),o.push(n),o.push(this.getAccountMiddleware()),o.push(s);const c=(0,i.Xj)(o);this.updateProviderEngineProxy(c),await r.init(),await this.lookupNetwork()}async updateAccount(e){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});await this._providerEngineProxy.request({method:"eth_private_key"})!==e.privateKey&&(await this.setupProvider(e.privateKey),this._providerEngineProxy.emit("accountsChanged",{accounts:await this._providerEngineProxy.request({method:"eth_accounts"})}))}async switchChain(e){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const r=this.getChainConfig(e.chainId);this.update({chainId:"loading"}),this.configure({chainConfig:r});const t=await this._providerEngineProxy.request({method:"eth_private_key"});await this.setupProvider(t)}async lookupNetwork(){if(!this._providerEngineProxy)throw c.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});const{chainId:e}=this.config.chainConfig;if(!e)throw c.ethErrors.rpc.invalidParams("chainId is required while lookupNetwork");const r=await this._providerEngineProxy.request({method:"net_version",params:[]});if(parseInt(e,16)!==parseInt(r,10))throw c.ethErrors.provider.chainDisconnected(`Invalid network, net_version is: ${r}`);return this.state.chainId!==e&&(this._providerEngineProxy.emit("chainChanged",e),this._providerEngineProxy.emit("connect",{chainId:e})),this.update({chainId:e}),r}getChainSwitchMiddleware(){return function(e){let{addChain:r,switchChain:t}=e;return(0,a.v0)({wallet_addEthereumChain:(0,a.Pk)((async function(e,t){var n;const i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!i)throw c.ethErrors.rpc.invalidParams("Missing chain params");if(!i.chainId)throw c.ethErrors.rpc.invalidParams("Missing chainId in chainParams");if(!i.rpcUrls||0===i.rpcUrls.length)throw c.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");if(!i.nativeCurrency)throw c.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");t.result=await r(i)})),wallet_switchEthereumChain:(0,a.Pk)((async function(e,r){var n;const i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(!i)throw c.ethErrors.rpc.invalidParams("Missing chainId");r.result=await t(i)}))})}({addChain:async e=>{const{chainId:r,chainName:t,rpcUrls:n,blockExplorerUrls:i,nativeCurrency:a}=e;this.addChain({chainNamespace:"eip155",chainId:r,ticker:(null===a||void 0===a?void 0:a.symbol)||"ETH",tickerName:(null===a||void 0===a?void 0:a.name)||"Ether",displayName:t,rpcTarget:n[0],blockExplorer:(null===i||void 0===i?void 0:i[0])||""})},switchChain:async e=>{const{chainId:r}=e;await this.switchChain({chainId:r})}})}getAccountMiddleware(){return function(e){let{updatePrivatekey:r}=e;return(0,a.v0)({wallet_updateAccount:(0,a.Pk)((async function(e,t){var n;const i=null!==(n=e.params)&&void 0!==n&&n.length?e.params[0]:void 0;if(null===i||void 0===i||!i.privateKey)throw c.ethErrors.rpc.invalidParams("Missing privateKey");t.result=await r(i)}))})}({updatePrivatekey:async e=>{const{privateKey:r}=e;await this.updateAccount({privateKey:r})}})}}(0,n.Z)(ue,"getProviderInstance",(async e=>{const r=new ue({config:{chainConfig:e.chainConfig}});return await r.setupProvider(e.privKey),r}))},46114:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__read||function(e,r){var t="function"===typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,a=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;var o=a(t(69282)),s=t(50523),c=t(95053),f=t(60571),u=t(16397),d=t(47107),p=t(91207),h=t(3323),l=t(89260),g=function(){function e(e,r,t,n){void 0===e&&(e=new s.BN(0)),void 0===r&&(r=new s.BN(0)),void 0===t&&(t=u.KECCAK256_RLP),void 0===n&&(n=u.KECCAK256_NULL),this.nonce=e,this.balance=r,this.stateRoot=t,this.codeHash=n,this._validate()}return e.fromAccountData=function(r){var t=r.nonce,n=r.balance,i=r.stateRoot,a=r.codeHash;return new e(t?new s.BN((0,d.toBuffer)(t)):void 0,n?new s.BN((0,d.toBuffer)(n)):void 0,i?(0,d.toBuffer)(i):void 0,a?(0,d.toBuffer)(a):void 0)},e.fromRlpSerializedAccount=function(e){var r=s.rlp.decode(e);if(!Array.isArray(r))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(r)},e.fromValuesArray=function(r){var t=i(r,4),n=t[0],a=t[1],o=t[2],c=t[3];return new e(new s.BN(n),new s.BN(a),o,c)},e.prototype._validate=function(){if(this.nonce.lt(new s.BN(0)))throw new Error("nonce must be greater than zero");if(this.balance.lt(new s.BN(0)))throw new Error("balance must be greater than zero");if(32!==this.stateRoot.length)throw new Error("stateRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")},e.prototype.raw=function(){return[(0,l.bnToUnpaddedBuffer)(this.nonce),(0,l.bnToUnpaddedBuffer)(this.balance),this.stateRoot,this.codeHash]},e.prototype.serialize=function(){return s.rlp.encode(this.raw())},e.prototype.isContract=function(){return!this.codeHash.equals(u.KECCAK256_NULL)},e.prototype.isEmpty=function(){return this.balance.isZero()&&this.nonce.isZero()&&this.codeHash.equals(u.KECCAK256_NULL)},e}();r.Account=g;r.isValidAddress=function(e){try{(0,h.assertIsString)(e)}catch(r){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.toChecksumAddress=function(e,r){(0,h.assertIsHexString)(e);var t=(0,f.stripHexPrefix)(e).toLowerCase(),n="";r&&(n=(0,l.toType)(r,l.TypeOutput.BN).toString()+"0x");for(var i=(0,p.keccakFromString)(n+t).toString("hex"),a="0x",o=0;o<t.length;o++)parseInt(i[o],16)>=8?a+=t[o].toUpperCase():a+=t[o];return a};r.isValidChecksumAddress=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.generateAddress=function(e,r){(0,h.assertIsBuffer)(e),(0,h.assertIsBuffer)(r);var t=new s.BN(r);return t.isZero()?(0,p.rlphash)([e,null]).slice(-20):(0,p.rlphash)([e,n.from(t.toArray())]).slice(-20)};r.generateAddress2=function(e,r,t){return(0,h.assertIsBuffer)(e),(0,h.assertIsBuffer)(r),(0,h.assertIsBuffer)(t),(0,o.default)(20===e.length),(0,o.default)(32===r.length),(0,p.keccak256)(n.concat([n.from("ff","hex"),e,r,(0,p.keccak256)(t)])).slice(-20)};r.isValidPrivate=function(e){return(0,c.privateKeyVerify)(e)};r.isValidPublic=function(e,r){return void 0===r&&(r=!1),(0,h.assertIsBuffer)(e),64===e.length?(0,c.publicKeyVerify)(n.concat([n.from([4]),e])):!!r&&(0,c.publicKeyVerify)(e)};r.pubToAddress=function(e,r){return void 0===r&&(r=!1),(0,h.assertIsBuffer)(e),r&&64!==e.length&&(e=n.from((0,c.publicKeyConvert)(e,!1).slice(1))),(0,o.default)(64===e.length),(0,p.keccak)(e).slice(-20)},r.publicToAddress=r.pubToAddress;r.privateToPublic=function(e){return(0,h.assertIsBuffer)(e),n.from((0,c.publicKeyCreate)(e,!1)).slice(1)};r.privateToAddress=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.importPublic=function(e){return(0,h.assertIsBuffer)(e),64!==e.length&&(e=n.from((0,c.publicKeyConvert)(e,!1).slice(1))),e};r.zeroAddress=function(){var e=(0,d.zeros)(20);return(0,d.bufferToHex)(e)};r.isZeroAddress=function(e){try{(0,h.assertIsString)(e)}catch(t){return!1}return(0,r.zeroAddress)()===e}},75770:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;var a=i(t(69282)),o=t(50523),s=t(47107),c=t(46114),f=function(){function e(e){(0,a.default)(20===e.length,"Invalid address length"),this.buf=e}return e.zero=function(){return new e((0,s.zeros)(20))},e.fromString=function(r){return(0,a.default)((0,c.isValidAddress)(r),"Invalid address"),new e((0,s.toBuffer)(r))},e.fromPublicKey=function(r){return(0,a.default)(n.isBuffer(r),"Public key should be Buffer"),new e((0,c.pubToAddress)(r))},e.fromPrivateKey=function(r){return(0,a.default)(n.isBuffer(r),"Private key should be Buffer"),new e((0,c.privateToAddress)(r))},e.generate=function(r,t){return(0,a.default)(o.BN.isBN(t)),new e((0,c.generateAddress)(r.buf,t.toArrayLike(n)))},e.generate2=function(r,t,i){return(0,a.default)(n.isBuffer(t)),(0,a.default)(n.isBuffer(i)),new e((0,c.generateAddress2)(r.buf,t,i))},e.prototype.equals=function(e){return this.buf.equals(e.buf)},e.prototype.isZero=function(){return this.equals(e.zero())},e.prototype.isPrecompileOrSystemAddress=function(){var e=new o.BN(this.buf),r=new o.BN(0),t=new o.BN("ffff","hex");return e.gte(r)&&e.lte(t)},e.prototype.toString=function(){return"0x"+this.buf.toString("hex")},e.prototype.toBuffer=function(){return n.from(this.buf)},e}();r.Address=f},47107:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__values||function(e){var r="function"===typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,r){var t="function"===typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,a=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o};Object.defineProperty(r,"__esModule",{value:!0}),r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;var o=t(50523),s=t(60571),c=t(3323);r.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Received an invalid integer type: ".concat(e));return"0x".concat(e.toString(16))};r.intToBuffer=function(e){var t=(0,r.intToHex)(e);return n.from((0,s.padToEven)(t.slice(2)),"hex")};r.zeros=function(e){return n.allocUnsafe(e).fill(0)};var f=function(e,t,n){var i=(0,r.zeros)(t);return n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)};r.setLengthLeft=function(e,r){return(0,c.assertIsBuffer)(e),f(e,r,!1)};r.setLengthRight=function(e,r){return(0,c.assertIsBuffer)(e),f(e,r,!0)};var u=function(e){for(var r=e[0];e.length>0&&"0"===r.toString();)r=(e=e.slice(1))[0];return e};r.unpadBuffer=function(e){return(0,c.assertIsBuffer)(e),u(e)};r.unpadArray=function(e){return(0,c.assertIsArray)(e),u(e)};r.unpadHexString=function(e){return(0,c.assertIsHexString)(e),e=(0,s.stripHexPrefix)(e),u(e)};r.toBuffer=function(e){if(null===e||void 0===e)return n.allocUnsafe(0);if(n.isBuffer(e))return n.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return n.from(e);if("string"===typeof e){if(!(0,s.isHexString)(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ".concat(e));return n.from((0,s.padToEven)((0,s.stripHexPrefix)(e)),"hex")}if("number"===typeof e)return(0,r.intToBuffer)(e);if(o.BN.isBN(e)){if(e.isNeg())throw new Error("Cannot convert negative BN to buffer. Given: ".concat(e));return e.toArrayLike(n)}if(e.toArray)return n.from(e.toArray());if(e.toBuffer)return n.from(e.toBuffer());throw new Error("invalid type")};r.bufferToInt=function(e){return new o.BN((0,r.toBuffer)(e)).toNumber()};r.bufferToHex=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")};r.fromSigned=function(e){return new o.BN(e).fromTwos(256)};r.toUnsigned=function(e){return n.from(e.toTwos(256).toArray())};r.addHexPrefix=function(e){return"string"!==typeof e||(0,s.isHexPrefixed)(e)?e:"0x"+e};r.toUtf8=function(e){if((e=(0,s.stripHexPrefix)(e)).length%2!==0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return n.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.baToJSON=function(e){if(n.isBuffer(e))return"0x".concat(e.toString("hex"));if(e instanceof Array){for(var t=[],i=0;i<e.length;i++)t.push((0,r.baToJSON)(e[i]));return t}};r.validateNoLeadingZeroes=function(e){var r,t;try{for(var n=i(Object.entries(e)),o=n.next();!o.done;o=n.next()){var s=a(o.value,2),c=s[0],f=s[1];if(void 0!==f&&f.length>0&&0===f[0])throw new Error("".concat(c," cannot have leading zeroes, received: ").concat(f.toString("hex")))}}catch(u){r={error:u}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(r)throw r.error}}},r.arrToBufArr=function e(r){return Array.isArray(r)?r.map((function(r){return e(r)})):n.from(r)},r.bufArrToArr=function e(r){return Array.isArray(r)?r.map((function(r){return e(r)})):Uint8Array.from(null!==r&&void 0!==r?r:[])}},16397:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=r.MAX_UINT64=void 0;var n=t(48764),i=t(50523);r.MAX_UINT64=new i.BN("ffffffffffffffff",16),r.MAX_INTEGER=new i.BN("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new i.BN("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=n.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=n.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=n.Buffer.from(r.KECCAK256_RLP_S,"hex")},50523:function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(r,t);i&&!("get"in i?!r.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,i)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(r,e,t);return i(r,e),r},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.rlp=r.BN=void 0;var s=o(t(13550));r.BN=s.default;var c=a(t(51675));r.rlp=c},91207:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160FromArray=r.ripemd160FromString=r.ripemd160=r.sha256FromArray=r.sha256FromString=r.sha256=r.keccakFromArray=r.keccakFromHexString=r.keccakFromString=r.keccak256=r.keccak=void 0;var i=t(82192),a=t(23482),o=t(50523),s=t(47107),c=t(3323);r.keccak=function(e,r){switch(void 0===r&&(r=256),(0,c.assertIsBuffer)(e),r){case 224:return(0,i.keccak224)(e);case 256:return(0,i.keccak256)(e);case 384:return(0,i.keccak384)(e);case 512:return(0,i.keccak512)(e);default:throw new Error("Invald algorithm: keccak".concat(r))}};r.keccak256=function(e){return(0,r.keccak)(e)};r.keccakFromString=function(e,t){void 0===t&&(t=256),(0,c.assertIsString)(e);var i=n.from(e,"utf8");return(0,r.keccak)(i,t)};r.keccakFromHexString=function(e,t){return void 0===t&&(t=256),(0,c.assertIsHexString)(e),(0,r.keccak)((0,s.toBuffer)(e),t)};r.keccakFromArray=function(e,t){return void 0===t&&(t=256),(0,c.assertIsArray)(e),(0,r.keccak)((0,s.toBuffer)(e),t)};var f=function(e){return e=(0,s.toBuffer)(e),a("sha256").update(e).digest()};r.sha256=function(e){return(0,c.assertIsBuffer)(e),f(e)};r.sha256FromString=function(e){return(0,c.assertIsString)(e),f(e)};r.sha256FromArray=function(e){return(0,c.assertIsArray)(e),f(e)};var u=function(e,r){e=(0,s.toBuffer)(e);var t=a("rmd160").update(e).digest();return!0===r?(0,s.setLengthLeft)(t,32):t};r.ripemd160=function(e,r){return(0,c.assertIsBuffer)(e),u(e,r)};r.ripemd160FromString=function(e,r){return(0,c.assertIsString)(e),u(e,r)};r.ripemd160FromArray=function(e,r){return(0,c.assertIsArray)(e),u(e,r)};r.rlphash=function(e){return(0,r.keccak)(o.rlp.encode(e))}},3323:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;var i=t(60571);r.assertIsHexString=function(e){if(!(0,i.isHexString)(e)){var r="This method only supports 0x-prefixed hex strings but input was: ".concat(e);throw new Error(r)}};r.assertIsBuffer=function(e){if(!n.isBuffer(e)){var r="This method only supports Buffer but input was: ".concat(e);throw new Error(r)}};r.assertIsArray=function(e){if(!Array.isArray(e)){var r="This method only supports number arrays but input was: ".concat(e);throw new Error(r)}};r.assertIsString=function(e){if("string"!==typeof e){var r="This method only supports strings but input was: ".concat(e);throw new Error(r)}}},53934:function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(r,t);i&&!("get"in i?!r.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,i)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__exportStar||function(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||n(r,e,t)};Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,i(t(16397),r),i(t(46114),r),i(t(75770),r),i(t(91207),r),i(t(3077),r),i(t(47107),r),i(t(9211),r),i(t(50523),r),i(t(89260),r);var a=t(60571);Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return a.isHexPrefixed}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return a.stripHexPrefix}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return a.padToEven}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return a.getBinarySize}}),Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return a.arrayContainsArray}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return a.toAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return a.fromUtf8}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return a.fromAscii}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return a.getKeys}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return a.isHexString}})},60571:function(e,r,t){var n=t(48764).Buffer;function i(e){if("string"!==typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type ".concat(typeof e));return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=i;function a(e){var r=e;if("string"!==typeof r)throw new Error("[padToEven] value must be type 'string', received ".concat(typeof r));return r.length%2&&(r="0".concat(r)),r}r.stripHexPrefix=function(e){if("string"!==typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received ".concat(typeof e));return i(e)?e.slice(2):e},r.padToEven=a,r.getBinarySize=function(e){if("string"!==typeof e)throw new Error("[getBinarySize] method requires input type 'string', recieved ".concat(typeof e));return n.byteLength(e,"utf8")},r.arrayContainsArray=function(e,r,t){if(!0!==Array.isArray(e))throw new Error("[arrayContainsArray] method requires input 'superset' to be an array, got type '".concat(typeof e,"'"));if(!0!==Array.isArray(r))throw new Error("[arrayContainsArray] method requires input 'subset' to be an array, got type '".concat(typeof r,"'"));return r[t?"some":"every"]((function(r){return e.indexOf(r)>=0}))},r.toAscii=function(e){var r="",t=0,n=e.length;for("0x"===e.substring(0,2)&&(t=2);t<n;t+=2){var i=parseInt(e.substr(t,2),16);r+=String.fromCharCode(i)}return r},r.fromUtf8=function(e){var r=n.from(e,"utf8");return"0x".concat(a(r.toString("hex")).replace(/^0+|0+$/g,""))},r.fromAscii=function(e){for(var r="",t=0;t<e.length;t++){var n=e.charCodeAt(t).toString(16);r+=n.length<2?"0".concat(n):n}return"0x".concat(r)},r.getKeys=function(e,r,t){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got ".concat(typeof e));if("string"!==typeof r)throw new Error("[getKeys] method expects input 'key' to be type 'string', got ".concat(typeof e));for(var n=[],i=0;i<e.length;i++){var a=e[i][r];if(t&&!a)a="";else if("string"!==typeof a)throw new Error("invalid abi - expected type 'string', received ".concat(typeof a));n.push(a)}return n},r.isHexString=function(e,r){return!("string"!==typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!r||e.length===2+2*r)}},9211:function(e,r,t){var n=t(48764).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var a=i(t(69282)),o=t(60571),s=t(50523),c=t(47107);r.defineProperties=function(e,r,t){if(e.raw=[],e._fields=[],e.toJSON=function(r){if(void 0===r&&(r=!1),r){var t={};return e._fields.forEach((function(r){t[r]="0x".concat(e[r].toString("hex"))})),t}return(0,c.baToJSON)(e.raw)},e.serialize=function(){return s.rlp.encode(e.raw)},r.forEach((function(r,t){function i(){return e.raw[t]}function o(i){"00"!==(i=(0,c.toBuffer)(i)).toString("hex")||r.allowZero||(i=n.allocUnsafe(0)),r.allowLess&&r.length?(i=(0,c.unpadBuffer)(i),(0,a.default)(r.length>=i.length,"The field ".concat(r.name," must not have more ").concat(r.length," bytes"))):r.allowZero&&0===i.length||!r.length||(0,a.default)(r.length===i.length,"The field ".concat(r.name," must have byte length of ").concat(r.length)),e.raw[t]=i}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:i,set:o}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:o,get:i})})),t)if("string"===typeof t&&(t=n.from((0,o.stripHexPrefix)(t),"hex")),n.isBuffer(t)&&(t=s.rlp.decode(t)),Array.isArray(t)){if(t.length>e._fields.length)throw new Error("wrong number of fields in data");t.forEach((function(r,t){e[e._fields[t]]=(0,c.toBuffer)(r)}))}else{if("object"!==typeof t)throw new Error("invalid data");var i=Object.keys(t);r.forEach((function(r){-1!==i.indexOf(r.name)&&(e[r.name]=t[r.name]),-1!==i.indexOf(r.alias)&&(e[r.alias]=t[r.alias])}))}}},3077:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var i=t(95053),a=t(50523),o=t(47107),s=t(91207),c=t(3323),f=t(89260);function u(e,r){var t=(0,f.toType)(e,f.TypeOutput.BN);if(t.eqn(0)||t.eqn(1))return(0,f.toType)(e,f.TypeOutput.BN);if(!r)return t.subn(27);var n=(0,f.toType)(r,f.TypeOutput.BN);return t.sub(n.muln(2).addn(35))}function d(e){var r=new a.BN(e);return r.eqn(0)||r.eqn(1)}r.ecsign=function(e,r,t){var a=(0,i.ecdsaSign)(e,r),o=a.signature,s=a.recid,c=n.from(o.slice(0,32)),u=n.from(o.slice(32,64));if(!t||"number"===typeof t){if(t&&!Number.isSafeInteger(t))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");return{r:c,s:u,v:t?s+(2*t+35):s+27}}return{r:c,s:u,v:(0,f.toType)(t,f.TypeOutput.BN).muln(2).addn(35).addn(s).toArrayLike(n)}};r.ecrecover=function(e,r,t,a,s){var c=n.concat([(0,o.setLengthLeft)(t,32),(0,o.setLengthLeft)(a,32)],64),f=u(r,s);if(!d(f))throw new Error("Invalid signature v value");var p=(0,i.ecdsaRecover)(c,f.toNumber(),e);return n.from((0,i.publicKeyConvert)(p,!1).slice(1))};r.toRpcSig=function(e,r,t,i){if(!d(u(e,i)))throw new Error("Invalid signature v value");return(0,o.bufferToHex)(n.concat([(0,o.setLengthLeft)(r,32),(0,o.setLengthLeft)(t,32),(0,o.toBuffer)(e)]))};r.toCompactSig=function(e,r,t,i){if(!d(u(e,i)))throw new Error("Invalid signature v value");var a=(0,f.toType)(e,f.TypeOutput.Number),s=t;return(a>28&&a%2===1||1===a||28===a)&&((s=n.from(t))[0]|=128),(0,o.bufferToHex)(n.concat([(0,o.setLengthLeft)(r,32),(0,o.setLengthLeft)(s,32)]))};r.fromRpcSig=function(e){var r,t,n,i=(0,o.toBuffer)(e);if(i.length>=65)r=i.slice(0,32),t=i.slice(32,64),n=(0,o.bufferToInt)(i.slice(64));else{if(64!==i.length)throw new Error("Invalid signature length");r=i.slice(0,32),t=i.slice(32,64),n=(0,o.bufferToInt)(i.slice(32,33))>>7,t[0]&=127}return n<27&&(n+=27),{v:n,r:r,s:t}};r.isValidSignature=function(e,r,t,n,i){void 0===n&&(n=!0);var o=new a.BN("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new a.BN("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==r.length||32!==t.length)return!1;if(!d(u(e,i)))return!1;var c=new a.BN(r),f=new a.BN(t);return!(c.isZero()||c.gt(s)||f.isZero()||f.gt(s))&&(!n||1!==f.cmp(o))};r.hashPersonalMessage=function(e){(0,c.assertIsBuffer)(e);var r=n.from("\x19Ethereum Signed Message:\n".concat(e.length),"utf-8");return(0,s.keccak)(n.concat([r,e]))}},89260:function(e,r,t){var n=t(48764).Buffer;Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=r.bnToRlp=r.bnToUnpaddedBuffer=r.bnToHex=void 0;var i,a=t(50523),o=t(60571),s=t(47107);function c(e){return(0,s.unpadBuffer)(e.toArrayLike(n))}r.bnToHex=function(e){return"0x".concat(e.toString(16))},r.bnToUnpaddedBuffer=c,r.bnToRlp=function(e){return c(e)},function(e){e[e.Number=0]="Number",e[e.BN=1]="BN",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(i=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,r){if(null===e)return null;if(void 0!==e){if("string"===typeof e&&!(0,o.isHexString)(e))throw new Error("A string must be provided with a 0x-prefix, given: ".concat(e));if("number"===typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");var t=(0,s.toBuffer)(e);if(r===i.Buffer)return t;if(r===i.BN)return new a.BN(t);if(r===i.Number){var n=new a.BN(t),c=new a.BN(Number.MAX_SAFE_INTEGER.toString());if(n.gt(c))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return n.toNumber()}return"0x".concat(t.toString("hex"))}}}}]);